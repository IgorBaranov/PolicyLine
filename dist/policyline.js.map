{"version":3,"sources":["webpack:///webpack/bootstrap 3f7aaeac8ea31f70139b","webpack:///./src/index.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/DI/index.js","webpack:///./src/DI/string.js","webpack:///./src/DI/location.js","webpack:///./src/DI/time.js","webpack:///external {\"commonjs\":\"moment\",\"commonjs2\":\"moment\"}"],"names":["namespace","settings","log","compileRule","rule","ruleReg","ruleArray","exec","slice","join","di","global","undefined","key","includes","Function","e","DI","register","name","fn","unregister","clear","loadPresets","fileName","fnName","compilePolicy","target","algorithm","effect","flag","rules","deny","forEach","push","user","action","env","resource","result","ruleResult","console","error","compileGroupExpression","origin","re","expr","expression","policies","RegExp","replace","compileCondition","condition","conditionReg","conditionArray","createCondition","wrap","container","value","substring","indexOf","length","wrapNamespaces","obj","prepareCondition","conditions","calculateCondition","source","data","Array","isArray","isObject","item","mergeDeep","Object","assign","property","Symbol","Policy","_expression","_policies","_condition","uniqID","Math","random","toString","substr","tmp","_groupConstructor","_singleConstructor","_mergeConstructor","policy","g","eval","window","module","exports","String","Location","Time","$trim","str","trim","$uppercase","toUpperCase","$lowercase","toLowerCase","$strToInt","parseInt","$timeBetween","time","start","end","currentTime","startTime","endTime","hour","isBefore","add","isBetween","$moment","date","pattern","unix","$day","val","param","day","$week","week","ceil","$month","month","$quarter","quarter","$year","year","$dataToTimestamp","format"],"mappings":"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","file":"policyline.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3f7aaeac8ea31f70139b","import files from './DI/index';\n\nconst namespace = 'abac_di';\n\nconst settings = {\n    log: true\n};\n\nfunction compileRule(rule) {\n    let ruleReg = /([^<>=]+)\\s?([<>=!]{1,2})\\s?(.+)/;\n    try {\n        let ruleArray = ruleReg.exec(rule).slice(1, 4);\n        if (ruleArray[1] === '=' || ruleArray[1] === '==') {\n            ruleArray[1] = '==='\n        }\n        rule = ruleArray.join('');\n\n        // DI section\n        let di = '';\n        if (global[namespace] !== undefined) {\n            for (const key in global[namespace]) {\n                if (rule.includes(key)) {\n                    di += 'var ' + key + '=' + namespace + '.' + key + ';';\n                }\n            }\n        }\n\n        // create returning function\n        return new Function('user', 'action', 'env', 'resource',\n            'var _a;' + di + 'try{_a=!!(' + rule + ');}catch(_e){_a=_e};return _a;');\n    } catch (e) {\n        return new Function('return new Error(\"in access rule: ' + rule + '\");');\n    }\n}\n\nlet DI = {\n    register(name, fn) {\n        if (global[namespace] === undefined) {\n            global[namespace] = {};\n        }\n\n        if (typeof name === 'function') {\n            global[namespace][name.name] = name;\n        } else {\n            global[namespace][name] = fn;\n        }\n    },\n\n    unregister(name) {\n        if (global[namespace] === undefined) {\n            return;\n        }\n\n        delete global[namespace][(typeof name === 'function') ? name.name : name];\n    },\n\n    clear() {\n        delete global[namespace];\n    },\n\n    loadPresets() {\n        for (const fileName in files) {\n            for (const fnName in files[fileName]) {\n                DI.register(fnName, files[fileName][fnName]);\n            }\n        }\n    }\n};\n\nfunction compilePolicy(target = [], algorithm = 'all', effect = 'deny') {\n    let flag = !(algorithm === 'any');\n    let rules = [];\n    let deny = effect === \"deny\";\n\n    target.forEach((rule) => {\n        rules.push(compileRule(rule));\n    });\n\n    return function (user, action, env, resource) {\n        let result = flag;\n\n        for (let rule of rules) {\n            let ruleResult = rule(user, action, env, resource);\n\n            // any case with errors to deny of whole policy\n            if (typeof ruleResult === 'object') {\n                if (settings.log) {\n                    console.error(ruleResult);\n                }\n                return false;\n            }\n\n            // using the algorithm\n            result = flag ? (result && ruleResult) : (result || ruleResult);\n        }\n\n        return deny ? !result : result;\n    }\n}\n\nfunction compileGroupExpression(origin) {\n    let re, expr = origin.expression;\n\n    for (const key in origin.policies) {\n        re = new RegExp('\\\\b' + key + '\\\\b', \"g\");\n        expr = expr.replace(re, 'data.' + key);\n    }\n\n    return expr\n        .replace(/\\bAND\\b/g, '&&')\n        .replace(/\\bOR\\b/g, '||');\n}\n\nfunction compileCondition(condition) {\n    let conditionReg = /([\\w\\.\\'\\\"\\$]+)\\s?([<>=!]{1,2})\\s?(.+)/; // more stricter than 'target' regexp\n    let conditionArray = conditionReg.exec(condition).slice(1, 4);\n\n    conditionArray[0] = conditionArray[0].replace('resource.', '');\n\n    return conditionArray;\n}\n\nfunction createCondition(expr) {\n    return new Function('user', 'action', 'env', 'resource', 'return ' + expr + ';');\n}\n\nfunction wrap(namespace, container, value) {\n    let key = namespace.substring(0, namespace.indexOf('.'));\n    let name = namespace.substring(namespace.indexOf('.') + 1);\n\n    if (namespace.indexOf('\\'') === 0 || namespace.indexOf('\"') === 0) {\n        key = '';\n        name = namespace.replace(/[\\'\\\"]/g, '');\n    }\n\n    if (name && name.includes('.') && key.length) {\n        if (!container[key])\n            container[key] = {};\n        wrap(name, container[key], value);\n    } else if (key.length) {\n        if (!container[key])\n            container[key] = {};\n        container[key][name] = value;\n    } else {\n        container[name] = value;\n    }\n\n    return container;\n}\n\nfunction wrapNamespaces(obj) {\n    for (let key in obj) {\n        if (key.includes('.')) {\n            wrap(key, obj, obj[key]);\n            delete obj[key];\n        }\n    }\n\n    return obj;\n}\n\nfunction prepareCondition(conditions) {\n    let result = {};\n    for (let condition of conditions) {\n        let rule = compileCondition(condition);\n        if (rule[1] === '=' || rule[1] === '==') {\n            result[rule[0]] = createCondition(rule[2]);\n        } else {\n            result[rule[0]] = [rule[1], createCondition(rule[2])];\n        }\n    }\n    return wrapNamespaces(result);\n}\n\nfunction calculateCondition(target, source, data) {\n    for (let key in source) {\n        if (Array.isArray(source[key])) {\n            target[key] = [source[key][0]];\n            target[key].push(source[key][1](data.user, data.action, data.env, data.resource));\n        } else if (typeof source[key] === 'function') {\n            target[key] = source[key](data.user, data.action, data.env, data.resource)\n        } else {\n            target[key] = {};\n            calculateCondition(target[key], source[key], data);\n        }\n    }\n    return target;\n}\n\nfunction isObject(item) {\n    return (item && typeof item === 'object' && !Array.isArray(item) && item !== null);\n}\n\nfunction mergeDeep(target, source) {\n    if (isObject(target) && isObject(source)) {\n        for (const key in source) {\n            if (isObject(source[key])) {\n                if (!target[key]) Object.assign(target, {[key]: {}});\n                mergeDeep(target[key], source[key]);\n            } else {\n                Object.assign(target, {[key]: source[key]});\n            }\n        }\n    }\n    return target || source;\n}\n\nlet property = Symbol();\n\nclass Policy {\n    _groupConstructor(origin) {\n        this._expression = compileGroupExpression(origin);\n        this._policies = {};\n        for (const key in origin.policies) {\n            let {target, algorithm, effect} = origin.policies[key];\n            this._policies[key] = compilePolicy(target, algorithm, effect);\n        }\n        this._condition = prepareCondition(origin.condition || []);\n    }\n\n    _singleConstructor(target, algorithm, effect, condition) {\n        let uniqID = '_' + Math.random().toString(36).substr(2, 9);\n        this._expression = 'data.' + uniqID;\n        this._policies = {\n            [uniqID]: compilePolicy(target, algorithm, effect)\n        };\n        this._condition = prepareCondition(condition || []);\n    }\n\n    _mergeConstructor(origin, source, effect) {\n        this._expression = origin._expression + effect + source._expression;\n        this._policies = Object.assign({}, origin._policies, source._policies);\n        let tmp = mergeDeep({}, origin._condition);\n        this._condition = mergeDeep(tmp, source._condition);\n    }\n\n    constructor(origin, source, effect) {\n        if ((origin.expression !== undefined) && (origin.policies !== undefined)) {\n            this._groupConstructor(origin);\n        } else if (source === undefined && effect === undefined) {\n            this._singleConstructor(origin.target, origin.algorithm, origin.effect, origin.condition);\n        } else {\n            this._mergeConstructor(origin, source, effect);\n        }\n\n        // private container for 'condition' part\n        this[property] = {};\n    }\n\n    check(user, action, env, resource) {\n        let result = {};\n        for (const key in this._policies) {\n            result[key] = this._policies[key](user, action, env, resource);\n        }\n\n        // save data for 'condition'\n        this[property] = {user, action, env, resource};\n\n        return (new Function('data', 'return ' + this._expression + ';'))(result);\n    }\n\n    condition(user, action, env, resource) {\n        let result = {\n            user: mergeDeep(user, this[property].user),\n            action: mergeDeep(action, this[property].action),\n            env: mergeDeep(env, this[property].env),\n            resource: mergeDeep(resource, this[property].resource)\n        };\n        this[property] = {};\n\n        try {\n            result.condition = calculateCondition({}, this._condition, result);\n        } catch (e) {\n            result = e;\n        }\n\n        return result;\n    }\n\n    and(policy) {\n        return new Policy(this, policy, '&&');\n    }\n\n    or(policy) {\n        return new Policy(this, policy, '||');\n    }\n}\n\n// static methods\nPolicy.compilePolicy = compilePolicy;\nPolicy.compileRule = compileRule;\n\n// service DI\nDI.loadPresets();\n\nexport {\n    Policy,\n    DI,\n    settings\n}\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/global.js","import String from './string';\nimport Location from './location';\nimport Time from './time';\n\nexport default {\n    String,\n    Location,\n    Time\n}\n\n\n// WEBPACK FOOTER //\n// ./src/DI/index.js","export default {\n    $trim: function(str) {\n        return str.trim();\n    },\n\n    $uppercase: function (str) {\n        return str.toUpperCase();\n    },\n\n    $lowercase: function (str) {\n        return str.toLowerCase();\n    },\n\n    $strToInt: function (str) {\n        return parseInt(str, 10);\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/DI/string.js","export default {\n}\n\n\n// WEBPACK FOOTER //\n// ./src/DI/location.js","import moment from 'moment';\n\nexport default {\n    // \"HH:mm a\"\n    $timeBetween(time, start, end) {\n        let currentTime = moment(time, \"HH:mm a\");\n        let startTime = moment(start, \"HH:mm a\");\n        let endTime = moment(end, \"HH:mm a\");\n\n        if ((startTime.hour() >= 12 && endTime.hour() <= 12) || endTime.isBefore(startTime)) {\n            endTime.add(1, \"days\"); // handle spanning days endTime\n\n            if (currentTime.hour() <= 12) {\n                currentTime.add(1, \"days\"); // handle spanning days currentTime\n            }\n        }\n\n        return currentTime.isBetween(startTime, endTime);\n    },\n\n    // return moment instance for target or comparison\n    $moment(date, pattern) {\n        if (pattern === 'unix') {\n            return moment.unix(date);\n        }\n        return moment(date, pattern);\n    },\n\n    // extract day number from timestamp value in 'week' or 'month'\n    $day(val, param = 'month') {\n        let day = moment.unix(val);\n        switch (param) {\n            case 'week':\n                day = day.day();\n                break;\n            default:\n                day = day.date();\n        }\n        return day;\n    },\n\n    // extract week number from timestamp value in 'month' or 'year'\n    $week(val, param = 'month') {\n        let week = moment.unix(val);\n        if (param === 'year') {\n            // localized week of the year\n            week = week.week();\n        } else {\n            week = Math.ceil(week.date() / 7);\n        }\n\n        return week;\n    },\n\n    // extract month number from timestamp value\n    $month(val) {\n        return moment.unix(val).month();\n    },\n\n    // extract quarter number from timestamp value\n    $quarter(val) {\n        return moment.unix(val).quarter();\n    },\n\n    // extract year from timestamp value\n    $year(val) {\n        return moment.unix(val).year()\n    },\n\n    // translate data to timestamp UTC value by pattern\n    $dataToTimestamp(val, pattern) {\n        return parseInt(moment(val, pattern).format('X'), 10);\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/DI/time.js","module.exports = require(\"moment\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"moment\",\"commonjs2\":\"moment\"}\n// module id = 6\n// module chunks = 0"],"sourceRoot":""}