module.exports=function(t){function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var e={};return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},r.p="",r(r.s=0)}([function(t,r,e){"use strict";function n(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.unregisterMutator=r.registerMutator=r.unregisterOperator=r.registerOperator=r.Policy=void 0;var o=function(){function t(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),u=e(1),i=Symbol(),a=function(){function t(r){n(this,t),this[i]={effect:"deny"!==r.effect,target:[]};var e=!0,o=!1,a=void 0;try{for(var f,c=r.target[Symbol.iterator]();!(e=(f=c.next()).done);e=!0){var s=f.value;this[i].target.push((0,u.parseExp)(s))}}catch(t){o=!0,a=t}finally{try{!e&&c.return&&c.return()}finally{if(o)throw a}}}return o(t,[{key:"check",value:function(t){var r={},e=void 0,n=void 0,o={},a=!0,f=!1,c=void 0;try{for(var s,l=this[i].target[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var p=s.value;e=Math.floor(65536*(1+Math.random())).toString(16).substring(1),n=(0,u.executeExp)(t,p,r,e),"boolean"==typeof n?o[e]=n:Object.assign(o,n)}}catch(t){f=!0,c=t}finally{try{!a&&l.return&&l.return()}finally{if(f)throw c}}var g=!0;return Object.values(o).forEach(function(t){g=g&&t}),this[i].effect?g:!g}}]),t}();r.Policy=a,r.registerOperator=u.registerOperator,r.unregisterOperator=u.unregisterOperator,r.registerMutator=u.registerMutator,r.unregisterMutator=u.unregisterMutator},function(t,r,e){"use strict";function n(t){var r="Semantic Error in "+t+": \n    Expression should be obj.attr[..mutator](operator)value or object.attribute\n    (user.role~=['admin','user'] , resource.location..radius=100)";throw new Error(r)}function o(t){return t.includes(".")&&(0===t.indexOf("user.")||0===t.indexOf("env.")||0===t.indexOf("action.")||0===t.indexOf("resource."))}function u(t){return t[0]===d&&t[t.length-1]===d&&(t='"'+t.substr(1,t.length-2)+'"'),t}function i(t){var r=t.split(".."),e=r.slice(1,r.length),n=o(r[0]),i=void 0;try{i=n?r[0]:JSON.parse(u(r[0]))}catch(t){var a="Parsing Error: \n\t unknown object - "+r[0]+" in expression";throw new Error(a)}return{isDIObj:n,value:i,mutators:e}}function a(t,r){var e=r.split("."),n=t,o=!0,u=!1,i=void 0;try{for(var a,f=e[Symbol.iterator]();!(o=(a=f.next()).done);o=!0){var c=a.value;try{n=n[c]}catch(t){n=null;break}}}catch(t){u=!0,i=t}finally{try{!o&&f.return&&f.return()}finally{if(u)throw i}}return n}function f(t,r,e){var n=void 0,o=void 0,u=r.value;r.isDIObj&&(u=a(t,u));var i=!0,f=!1,c=void 0;try{for(var s,l=r.mutators[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var p=s.value;r.isDIObj&&(e[r.value]=e[r.value]||{},n=e[r.value]),o=(0,v.getMutators)()[p],o&&"function"!=typeof o&&(o=o[v.prefix]),u=o?o(u,n):u}}catch(t){f=!0,c=t}finally{try{!i&&l.return&&l.return()}finally{if(f)throw c}}return u}function c(t){var r=(0,g.getOperators)(),e=void 0,o=void 0;for(e in r)if(o=t.split(e),2===o.length)break;return 2===o.length&&y.test(o[0])&&h.test(o[1])||n(t),{origin:t,left:i(o[0]),operator:e,right:i(o[1])}}function s(t,r,e,n){var o=(0,v.getMutators)(),u=!0,i=!1,a=void 0;try{for(var f,c=t.mutators[Symbol.iterator]();!(u=(f=c.next()).done);u=!0){var s=f.value;t.isDIObj&&"object"===p(o[s])&&o[s][v.postfix]&&(r.result=o[s][v.postfix](r,e[t.value],n))}}catch(t){i=!0,a=t}finally{try{!u&&c.return&&c.return()}finally{if(i)throw a}}}function l(t,r,e,n){var o=(0,g.getOperators)(),u=f(t,r.left,e,n),i=f(t,r.right,e,n),a="*";r.left.isDIObj&&"function"==typeof o[r.operator][r.left.value]?a=r.left.value:r.right.isDIObj&&"function"==typeof o[r.operator][r.right.value]&&(a=r.right.value);var c=o[r.operator][a](u,i),l={leftIsData:!r.left.isDIObj,rightIsData:!r.right.isDIObj,leftValue:u,rightValue:i,result:c};return s(r.left,l,e,n),s(r.right,l,e,n),l.result}Object.defineProperty(r,"__esModule",{value:!0}),r.unregisterMutator=r.registerMutator=r.unregisterOperator=r.registerOperator=r.executeExp=r.parseExp=void 0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g=e(2),v=e(3),y=/^[a-zA-Z]+\.[a-zA-Z]+(?:\.\.[a-zA-Z]+)*/,h=/[^\n]+/,d="'";r.parseExp=c,r.executeExp=l,r.registerOperator=g.registerOperator,r.unregisterOperator=g.unregisterOperator,r.registerMutator=v.registerMutator,r.unregisterMutator=v.unregisterMutator},function(t,r,e){"use strict";function n(){return i}function o(t,r,e){i[t]=i[t]||{},i[t][r]=e;var n={};Object.entries(i).sort(function(t,r){return t[0].length<r[0].length?1:t[0].length>r[0].length?-1:0}).forEach(function(t){n[t[0]]=t[1]}),i=n}function u(t,r){var e=i[t];delete e[r],0===Object.keys(e).length&&delete i[t]}Object.defineProperty(r,"__esModule",{value:!0});var i={"==":{"*":function(t,r){return t===r}},"!=":{"*":function(t,r){return t!==r}},">=":{"*":function(t,r){return t>=r}},"<=":{"*":function(t,r){return t<=r}},"~=":{"*":function(t,r){return!!Array.isArray(r)&&r.includes(t)}},"^=":{"*":function(t,r){return!!Array.isArray(r)&&!r.includes(t)}},"?=":{"*":function(t,r){return!t||t===r}},"=":{"*":function(t,r){return t===r}},">":{"*":function(t,r){return t>r}},"<":{"*":function(t,r){return t<r}}};r.getOperators=n,r.registerOperator=o,r.unregisterOperator=u},function(t,r,e){"use strict";function n(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function o(t){return t instanceof Date?t:new Date(t)}function u(){return s}function i(t,r,e){var o;s[t]=(o={},n(o,f,r),n(o,c,e),o)}function a(t){delete s[t]}Object.defineProperty(r,"__esModule",{value:!0});var f=Symbol(),c=Symbol(),s={radius:n({},c,function(t,r,e){return t.leftIsData?r.radius=t.leftValue:r.radius=t.rightValue,!0}),inArea:n({},c,function(t,r,e){function n(t){return t*(Math.PI/180)}var o=function(t,r,e,o){var u=n(e-t),i=n(o-r),a=Math.sin(u/2)*Math.sin(u/2)+Math.cos(n(t))*Math.cos(n(e))*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371}(t.rightValue[0],t.rightValue[1],t.leftValue[0],t.leftValue[1]);return r.radius>=o}),or:n({},c,function(t,r,e){if(r.container=r.container||{},r.container[e]=t.result,t.result)for(var n in r.container)r.container[n]=!0;return r.container}),toInt:function(t){return parseInt(t,10)},toString:function(t){return t+""},trim:function(t){return t.trim()},uppercase:function(t){return t.toUpperCase()},lowercase:function(t){return t.toLowerCase()},minute:function(t){return o(t).getMinutes()},day:function(t){return o(t).getDate()},hour:function(t){return o(t).getHours()},weekday:function(t){return o(t).getDay()},month:function(t){return o(t).getMonth()},year:function(t){return o(t).getFullYear()}};r.getMutators=u,r.prefix=f,r.postfix=c,r.registerMutator=i,r.unregisterMutator=a}]);