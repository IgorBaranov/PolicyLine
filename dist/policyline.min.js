module.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(t){var n=/([^<>=]+)\s?([<>=!]{1,2})\s?(.+)/;try{var r=n.exec(t);r&&(r=r.slice(1,4),"="!==r[1]&&"=="!==r[1]||(r[1]="==="),t=r.join(""));var o="";if(void 0!==e[g])for(var i in e[g])t.includes(i)&&(o+="var "+i+"="+g+"."+i+";");return new Function("user","action","env","resource","var _a;"+o+"try{_a=!!("+t+");}catch(_e){_a=_e};return _a;")}catch(e){return new Function('return new Error("in access rule: '+t+'");')}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"deny",r=!("any"===t),o=[],u="deny"===n;return e.forEach(function(e){o.push(i(e))}),function(e,t,n,i){var c=r,a=!0,s=!1,f=void 0;try{for(var l,d=o[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var v=l.value,y=v(e,t,n,i);if("object"===(void 0===y?"undefined":m(y)))return x.log&&console.error(y),!1;c=r?c&&y:c||y}}catch(e){s=!0,f=e}finally{try{!a&&d.return&&d.return()}finally{if(s)throw f}}return u?!c:c}}function c(e){var t=void 0,n=e.expression;for(var r in e.policies)t=new RegExp("\\b"+r+"\\b","g"),n=n.replace(t,"data."+r);return n.replace(/\bAND\b/g,"&&").replace(/\bOR\b/g,"||")}function a(e){var t=/([\w\.\'\"\$]+)\s?([<>=!]{1,2})\s?(.+)/,n=t.exec(e).slice(1,4);return n[0]=n[0].replace("resource.",""),n}function s(e){return new Function("user","action","env","resource","return "+e+";")}function f(e,t,n){var r=e.substring(0,e.indexOf(".")),o=e.substring(e.indexOf(".")+1);return 0!==e.indexOf("'")&&0!==e.indexOf('"')||(r="",o=e.replace(/[\'\"]/g,"")),o&&o.includes(".")&&r.length?(t[r]||(t[r]={}),f(o,t[r],n)):r.length?(t[r]||(t[r]={}),t[r][o]=n):t[o]=n,t}function l(e){for(var t in e)t.includes(".")&&(f(t,e,e[t]),delete e[t]);return e}function d(e){var t={},n=!0,r=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var c=i.value,f=a(c);"="===f[1]||"=="===f[1]?t[f[0]]=s(f[2]):t[f[0]]=[f[1],s(f[2])]}}catch(e){r=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw o}}return l(t)}function v(e,t,n){for(var r in t)Array.isArray(t[r])?(e[r]=[t[r][0]],e[r].push(t[r][1](n.user,n.action,n.env,n.resource))):"function"==typeof t[r]?e[r]=t[r](n.user,n.action,n.env,n.resource):(e[r]={},v(e[r],t[r],n));return e}function y(e){return e&&"object"===(void 0===e?"undefined":m(e))&&!Array.isArray(e)&&null!==e}function p(e,t){if(y(e)&&y(t))for(var n in t)y(t[n])?(e[n]||Object.assign(e,o({},n,{})),p(e[n],t[n])):Object.assign(e,o({},n,t[n]));return e||t}Object.defineProperty(t,"__esModule",{value:!0}),t.settings=t.DI=t.Policy=void 0;var h=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b=n(2),_=function(e){return e&&e.__esModule?e:{default:e}}(b),g="abac_di",x={log:!0},w={register:function(t,n){void 0===e[g]&&(e[g]={}),"function"==typeof t?e[g][t.name]=t:e[g][t]=n},unregister:function(t){void 0!==e[g]&&delete e[g]["function"==typeof t?t.name:t]},clear:function(){delete e[g]},loadPresets:function(){for(var e in _.default)for(var t in _.default[e])w.register(t,_.default[e][t])}},O=Symbol(),j=function(){function e(t,n,o){r(this,e),void 0!==t.expression&&void 0!==t.policies?this._groupConstructor(t):void 0===n&&void 0===o?this._singleConstructor(t.target,t.algorithm,t.effect,t.condition):this._mergeConstructor(t,n,o),this[O]={}}return h(e,[{key:"_groupConstructor",value:function(e){this._expression=c(e),this._policies={};for(var t in e.policies){var n=e.policies[t],r=n.target,o=n.algorithm,i=n.effect;this._policies[t]=u(r,o,i)}this._condition=d(e.condition||[])}},{key:"_singleConstructor",value:function(e,t,n,r){var i="_"+Math.random().toString(36).substr(2,9);this._expression="data."+i,this._policies=o({},i,u(e,t,n)),this._condition=d(r||[])}},{key:"_mergeConstructor",value:function(e,t,n){this._expression=e._expression+n+t._expression,this._policies=Object.assign({},e._policies,t._policies);var r=p({},e._condition);this._condition=p(r,t._condition)}}]),h(e,[{key:"check",value:function(e,t,n,r){var o={};for(var i in this._policies)o[i]=this._policies[i](e,t,n,r);return this[O]={user:e,action:t,env:n,resource:r},new Function("data","return "+this._expression+";")(o)}},{key:"condition",value:function(e,t,n,r){var o={user:p(e,this[O].user),action:p(t,this[O].action),env:p(n,this[O].env),resource:p(r,this[O].resource)};this[O]={};try{var i=v({},this._condition,o);o.condition=p(i,o.resource)}catch(e){o=e}return o}},{key:"and",value:function(t){return new e(this,t,"&&")}},{key:"or",value:function(t){return new e(this,t,"||")}}]),e}();j.compilePolicy=u,j.compileRule=i,w.loadPresets(),t.Policy=j,t.DI=w,t.settings=x}).call(t,n(1))},function(e,t,n){"use strict";var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":o(window))&&(r=window)}e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=r(o),u=n(4),c=r(u),a=n(5),s=r(a);t.default={String:i.default,Location:c.default,Time:s.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={$trim:function(e){return e.trim()},$uppercase:function(e){return e.toUpperCase()},$lowercase:function(e){return e.toLowerCase()},$strToInt:function(e){return parseInt(e,10)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={$timeBetween:function(e,t,n){var r=(0,o.default)(e,"HH:mm a"),i=(0,o.default)(t,"HH:mm a"),u=(0,o.default)(n,"HH:mm a");return(i.hour()>=12&&u.hour()<=12||u.isBefore(i))&&(u.add(1,"days"),r.hour()<=12&&r.add(1,"days")),r.isBetween(i,u)},$moment:function(e,t){return"unix"===t?o.default.unix(e):(0,o.default)(e,t)},$day:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"month",n=o.default.unix(e);switch(t){case"week":n=n.day();break;default:n=n.date()}return n},$week:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"month",n=o.default.unix(e);return n="year"===t?n.week():Math.ceil(n.date()/7)},$month:function(e){return o.default.unix(e).month()},$quarter:function(e){return o.default.unix(e).quarter()},$year:function(e){return o.default.unix(e).year()},$dataToTimestamp:function(e,t){return parseInt((0,o.default)(e,t).format("X"),10)}}},function(e,t){e.exports=require("moment")}]);